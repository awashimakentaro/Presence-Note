# Presence Note

Presence Note は、
**離れていても「そばにいる感覚」を物理的に届けるためのシステム**です。

送信者が手書きで作成したメッセージ（画像）を ntfy 経由で送信し、
受信側に設置された Raspberry Pi + 感熱プリンタが
**何の操作も要求せず、静かに印刷**します。

このプロジェクトは、
効率や自動化よりも **心理的安全性・非侵襲性・存在感**を重視します。

---

## コンセプト

* 監視しない
* 強制しない
* 保存しない
* 判断しない
* 失敗は静かに無視する

Presence Note は「通知システム」ではありません。
**存在の痕跡を、物理として残す装置**です。

---

## 全体構成（概要）

```
[ iPad / iPhone ]
  └ 手書き + 写真（1枚の画像）
        ↓
      ntfy
        ↓
[ Raspberry Pi ]
  ├─ 画像正規化
  └─ 感熱プリンタ印刷
```

* 送信形式：**毎回 1 枚の画像（PNG / JPEG）**
* レイアウト・サイズ・向き：**完全自由**
* 受信側操作：**一切不要**

---

## ディレクトリ構成

```
.
├─ AGENTS.md          # 最重要：行動規範・開発ルール
├─ README.md          # 本ファイル
├─ docs/
│  ├─ 要件定義書.md
│  └─ 設計書.md
└─ app/
   ├─ image_processor.py
   ├─ printer.py
   ├─ subscriber.py
   ├─ service.py
   └─ main.py
```

---

## 🚨 最重要ルール（必ず読む）

### AI / 人間を問わず、必ず守ること

* **AGENTS.md が最優先**
* 設計書.md・要件定義書.md を前提にする
* SRP（単一責務原則）を厳守
* すべてのファイル・関数に日本語ドキュメントを書く

👉 詳細は **AGENTS.md** を参照。

---

## Codex（AI）を使った作業の進め方

### 原則

* **1 回の Codex 実行 = 1 ファイル**
* 勝手に複数ファイルを編集させない
* 毎回「読むべきドキュメント」を明示する

---

### 推奨コマンド例（テンプレ）

```bash
codex exec '
You are an AI agent working on Presence Note.
Read AGENTS.md, docs/設計書.md, and docs/要件定義書.md carefully.
Follow them strictly.
Do NOT expand scope.
Implement only app/image_processor.py. 
'
```

### ポイント

* `Read AGENTS.md` は **必須**
* `Implement only ...` で作業範囲を固定
* 別ファイルを触りたい場合は **次の実行で指定し直す**

---

## 実装の進め方（推奨順）

1. `image_processor.py`

   * 画像正規化（最も重要・独立性が高い）

2. `printer.py`

   * 感熱プリンタ制御

3. `subscriber.py`

   * ntfy 購読処理

4. `service.py`

   * 受信 → 処理 → 印刷 の調停

5. `main.py`

   * エントリポイント / systemd 用

👉 各ステップで **1 ファイルずつ**進めること。

---

## 開発ポリシー

* 状態を持たない
* 永続化しない
* 履歴を残さない
* 再試行しない
* 失敗はログ 1 行のみ

**「便利だから」は理由にならない。**
設計に書いていないことは、実装しない。

---

## 将来について（v2 以降）

* Web UI
* 送信補助ツール
* 印刷フォーマット拡張

これらは **v1 では行わない**。
追加する場合は、必ず設計と AGENTS.md を更新する。

---

## このプロジェクトについて

Presence Note は
**技術プロジェクトであると同時に、感情を扱うプロジェクト**です。

コードの正しさよりも、
**振る舞いの誠実さ**を優先してください。
